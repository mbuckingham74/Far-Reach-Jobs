{% extends "base.html" %}

{% block title %}Far Reach Jobs - Alaska Bush & Rural US Jobs{% endblock %}

{% block content %}
<div class="mb-6 sm:mb-8">
    <h2 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">Find Jobs in Remote Alaskan Communities</h2>
    <p class="text-gray-600 dark:text-gray-300">Discover job opportunities in Alaska bush communities and rural US towns.</p>
</div>

<!-- Stats Banner -->
<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 mb-6 sm:mb-8"
     hx-get="/api/jobs/stats"
     hx-trigger="load"
     hx-swap="innerHTML">
    <!-- Placeholder while loading -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 text-center">
        <div class="text-2xl sm:text-3xl font-bold text-blue-600 dark:text-blue-400">-</div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Sources</div>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 text-center">
        <div class="text-2xl sm:text-3xl font-bold text-purple-600 dark:text-purple-400">-</div>
        <div class="text-sm text-gray-600 dark:text-gray-400">Jobs Available</div>
    </div>
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 text-center">
        <div class="text-2xl sm:text-3xl font-bold text-green-600 dark:text-green-400">-</div>
        <div class="text-sm text-gray-600 dark:text-gray-400">New This Week</div>
    </div>
</div>

<!-- Search and Filters -->
<div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 sm:p-6 mb-6 transition-colors">
    <form id="job-filters"
          hx-get="/api/jobs"
          hx-target="#job-list"
          hx-trigger="submit"
          hx-indicator="#job-list-container">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
            <div>
                <label for="q" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Search</label>
                <input type="text" id="q" name="q" placeholder="Job title, keywords..."
                       hx-get="/api/jobs"
                       hx-target="#job-list"
                       hx-trigger="keyup changed delay:400ms"
                       hx-include="#job-filters"
                       class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 dark:text-white dark:placeholder-gray-400">
            </div>
            <div>
                <label for="state" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">State</label>
                <select id="state" name="state"
                        hx-get="/api/jobs"
                        hx-target="#job-list"
                        hx-trigger="change"
                        hx-include="#job-filters"
                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 dark:text-white">
                    <option value="">All States</option>
                    <option value="AK">Alaska</option>
                    <option value="AL">Alabama</option>
                    <option value="AR">Arkansas</option>
                    <option value="AZ">Arizona</option>
                    <option value="CA">California</option>
                    <option value="CO">Colorado</option>
                    <option value="ID">Idaho</option>
                    <option value="MT">Montana</option>
                    <option value="NM">New Mexico</option>
                    <option value="NV">Nevada</option>
                    <option value="OR">Oregon</option>
                    <option value="UT">Utah</option>
                    <option value="WA">Washington</option>
                    <option value="WY">Wyoming</option>
                </select>
            </div>
            <div>
                <label for="job_type" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Job Type</label>
                <select id="job_type" name="job_type"
                        hx-get="/api/jobs"
                        hx-target="#job-list"
                        hx-trigger="change"
                        hx-include="#job-filters"
                        class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white dark:bg-gray-700 dark:text-white">
                    <option value="">All Types</option>
                    <option value="full-time">Full-time</option>
                    <option value="part-time">Part-time</option>
                    <option value="seasonal">Seasonal</option>
                    <option value="contract">Contract</option>
                    <option value="temporary">Temporary</option>
                </select>
            </div>
        </div>
        <div class="mt-4 flex flex-col sm:flex-row gap-2">
            <button type="submit" class="w-full sm:w-auto px-4 py-2 bg-primary-600 hover:bg-primary-700 text-white font-medium rounded-md transition-colors">
                Search
            </button>
            <button type="button" onclick="clearFilters()" class="w-full sm:w-auto px-4 py-2 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 text-gray-700 dark:text-gray-200 font-medium rounded-md transition-colors">
                Clear Filters
            </button>
        </div>
    </form>
</div>

<!-- Job Listings Container -->
<div id="job-list-container">
    <!-- Loading indicator -->
    <div id="loading-indicator" class="htmx-indicator text-center py-12">
        <div class="inline-block w-8 h-8 border-4 border-gray-200 dark:border-gray-700 border-t-primary-600 rounded-full animate-spin"></div>
        <p class="mt-3 text-gray-500 dark:text-gray-400">Loading jobs...</p>
    </div>

    <!-- Job Listings -->
    <div id="job-list" hx-get="/api/jobs" hx-trigger="load" hx-indicator="closest #job-list-container">
        <!-- Jobs will be loaded here via HTMX -->
    </div>
</div>

<style>
    #job-list-container.htmx-request .htmx-indicator {
        display: block;
    }
    #job-list-container.htmx-request #job-list {
        opacity: 0.5;
        transition: opacity 0.2s ease;
    }
</style>

<script>
function clearFilters() {
    document.getElementById('q').value = '';
    document.getElementById('state').value = '';
    document.getElementById('job_type').value = '';
    htmx.trigger('#job-filters', 'submit');
}
</script>
{% endblock %}
